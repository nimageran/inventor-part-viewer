function extractAllMetadata(obj) {
      const metadata = {
        name: 'Unknown',
        type: null,
        description: null,
        material: null,
        partNumber: null,
        stock: null,
        mass: null,
        volume: null,
        surfaceArea: null,
        manufacturer: null,
        partType: null,
        userData: {},
        geometry: {},
        materialInfo: {},
        custom: {}
      };

      // First, extract userData to check for 'name' in custom properties
      let current = obj;
      let foundCustomName = false;
      
      while (current) {
        if (current.userData && Object.keys(current.userData).length > 0) {
          Object.assign(metadata.userData, current.userData);
          
          // Check if 'name' exists in userData (Custom Properties)
          if (current.userData.name && !foundCustomName) {
            metadata.name = current.userData.name;
            foundCustomName = true;
          }
        }
        current = current.parent;
      }

      // Only extract name from hierarchy if not found in userData
      if (!foundCustomName) {
        current = obj;
        while (current) {
          if (current.name && 
              !current.name.toLowerCase().includes('solid') &&
              !current.name.toLowerCase().includes('mesh') &&
              !current.name.toLowerCase().includes('scene') &&
              current.name !== '') {
            metadata.name = current.name;
            break;
          }
          current = current.parent;
        }
      }
